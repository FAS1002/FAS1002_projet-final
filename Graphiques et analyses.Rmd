---
title: "Partie Bertrand"
author: "Bertrand"
date: "2022-12-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(lubridate)
library(fs)
source("evironnement_datas.R")

```

## Graphique sur la relation entre PIB et CO2

Nous voulons tester l'effet de la croissance du PIB sur l'emprunte carbone des individus. Nous posons l'hypothèse que les deux variables seraient positivement correlé. En effet, un accroissement du niveau de vie (PIB) amenerait les individus à entreprendre des styles de vies plus intensifs en utilisation de carbone, tel que la consommation d'automobile, d'air climatiser, etc. Nous posons aussi l'hypothèse que cette relation serait similaire à travers les continents, démontrant ainsi que le biais culturel n'affecterait pas le relation entre la croissance du niveau de vie et des émissions de CO2.

```{r}
graphique_co2_pib <- ggplot(data=dat_2015, aes(x=gdp, y = co2_per_capita, color = continent)) +

    geom_point()+ scale_x_continuous(trans = "log10")+

    scale_y_continuous(trans = "log10") +

    labs(title = "Évolution des émissions de CO2 par habitant en fonction du PIB en 2015", x="PIB", y="CO2 par PIB", caption = "Données tirées de World in Data") + theme

graphique_co2_pib + geom_smooth(se = FALSE, method = lm)
```

Comme on peut voir dans le graphique, il y a une relation positive entre la croissance du PIB et de l'intensité de CO2 par habitant. Cette relation est similaire à travers les continents. Il est important de noter que les axes évoluent de manière logarithmique, exprimant ainsi une relation plus forte.

## Graphiques sur l'évolution du CO2 et population depuis 1850

Ces graphiques présentent l'évolutions des émissions de CO2, de la population et du CO2 par habitant depuis 1850 pour l'ensemble des continents.

```{r}
# Évolution du Co2 depuis 1850 selon les continents
graph_evol_co2 <- ggplot(dat_continent, aes(x=year, y=co2)) +
    geom_line(aes(color=country),size = 1.2) + xlim(1850, 2020) +
    theme +
    labs(color = "Continent") +
    labs(title = "Évolution des émissions de CO2 depuis 1850", x="Année", y="CO2 (spécifier)",caption = "Données tirées de World in Data")


# Évolution de la population depuis 1850 selon les continents
graph_evol_pop <- ggplot(dat_continent, aes(x=year, y=population)) +
    geom_line(aes(color=country),size = 1.2) + xlim(1850, 2020) +
    theme + labs(color = "Continent") +
    labs(title = " Évolution de la population depuis 1850 selon les continents", x="Année", y="Population",
         caption = "Données tirées de World in Data")

graph_evol_co2c <- ggplot(dat_continent, aes(x=year, y=co2_per_capita)) +
    geom_line(aes(color=country),size = 1.2) + xlim(1850, 2020) +
    theme + labs(color = "Continent") +
    labs(title = " Évolution du CO2/habitant depuis 1850 selon les continents", x="Année", y="CO2 par habitants",
         caption = "Données tirées de World in Data")

graph_evol_co2
graph_evol_pop
graph_evol_co2c

```

Ces graphiques révèlent plusieurs informations d'intérêts. D'une part, la population a évolué de manière exponentielle en Asie suite à la Seconde Guerre mondiale. La population africaine suit une tendance similaire, mais moins forte. D'autre part, malgré une réduction presque systématique (sauf en Asie) des émissions de CO2 par habitant, les émissions totales continuent tout de même d'augmenter significativement. On observe l'effet de l'explosion de population, particulièrement en Asie, sur les émissions totales de C02.

Ainsi, dans un contexte de réchauffement climatique et d'effort de réduction d'émission de CO2, il est important de réduire davantage les émissions par habitant afin de contrer l'effet d'augmentation total d'émission engendré par la croissance de la population, particulièrement en Afrique et en Asie.

## Graphique sur l'évolution de la distribution des pays en fonction de leur PIB par habitant

Ces graphiques ont comme but de comparer la distribution du PIB par habitant des continents

```{r}
graph_2015 <- ggplot(data = dat_2015, aes(x = gdp_per_capita, fill = continent)) +
    geom_density(alpha = .4) +
    scale_x_continuous(limits = c(0,40000)) +
    theme  +
    labs(title = "2015", x="PIB par habitant", y="Densité", caption = "Données tirées de World in Data") + 
    scale_y_continuous(limits=(c(0, 0.00065)))


graph_1995 <- ggplot(data = dat_1995, aes(x = gdp_per_capita, fill = continent)) +
    geom_density(alpha = .4) +
    scale_x_continuous(limits = c(0,30000)) +
    theme +
    labs(title = "1995", x="PIB par habitant", y="Densité", caption = "Données de l'Océanie seulement disponibles pour la Nouvelle-Zélande et l'Australie") + scale_y_continuous(limits=(c(0, 0.00065)))



graph_1975 <- ggplot(data = dat_1975, aes(x = gdp_per_capita, fill = continent)) +
    geom_density(alpha = .4) +
    scale_x_continuous(limits = c(0,30000)) +
    theme +
    labs(title = "1975", x="PIB par habitant", y="Densité")+
    scale_y_continuous(limits=(c(0, 0.00065)))


graph_1955 <- ggplot(data = dat_1955, aes(x = gdp_per_capita, fill = continent)) +
    geom_density(alpha = .4) +
    scale_x_continuous(limits = c(0,30000)) +
    theme +
    labs(title = "1955", x="PIB par habitant (jusqu'à 40 000$", y="Densité") + 
    scale_y_continuous(limits=(c(0, 0.00065)))



suppressWarnings(print(graph_1955 + graph_1975 + graph_1995 + graph_2015) +
    plot_annotation(title = "Distribution du PIB par habitant à chaque 20 ans depuis 1955"))

```

D'une part, on constate qu'en 1950, le continent Africain, Américain et Asiatique avait des PIB par habitant qui étaient généralement en dessous de 5000\$ par habitant en juxtaposition à l'Europe et l'Océanie (Australie et Nouvelle-Zélande) qui avait des PIB/habitant plus élévé. Toutefois, on observe que les distributions pour l'ensemble des continents se sont progressivement applati au fil des décénnies. En effet, en 2015, on constate que la plupart des continents (sauf l'Afrique) ont dépassé la moyenne de 10 000\$ par habitant.

D'autre part, on constate que malgré le fait que les pays sont plus riche, il y a aussi davantage d'inégalité entre la richesse par habitant des pays, particulièrement entre les continents occidentaux comme l'Europe en comparaison à l'Afrique.

## Graphiques sur l'évolution de la distribution des émissions de CO2 par habitant depuis 1955.

```{r}
co2_2015 <- ggplot(data = dat_2015, aes(x = co2_per_capita, fill = continent)) +
    geom_density(alpha=0.4) +
    theme  +
    labs(title = "2015", x="CO2 par habitant", y="Densité", caption = "Données tirées de World in Data") + scale_x_continuous(limits=c(0,10)) +
     scale_y_continuous(limits=(c(0, 1.5)))


co2_1995 <- ggplot(data = dat_1995, aes(x = co2_per_capita, fill = continent)) + 
    geom_density(alpha=0.4) +
    theme +
    scale_x_continuous(limits = c(0,10)) +
    labs(title = "1995", x="CO2 par habitant", y="Densité")+
     scale_y_continuous(limits=(c(0, 1.5)))


co2_1975 <- ggplot(data = dat_1975, aes(x = co2_per_capita, fill = continent)) +
    geom_density(alpha=0.4) +
    scale_x_continuous(limits = c(0,10)) +
    theme +
    labs(title = "1975", x="CO2 par habitant", y="Densité")+
     scale_y_continuous(limits=(c(0, 1.5)))


co2_1955 <- ggplot(data = dat_1955, aes(x = co2_per_capita, fill = continent)) +
    geom_density(alpha=0.4) +
    scale_x_continuous(limits = c(0,10)) +
    theme +
    labs(title = "1955", x="CO2 par habitant", y="Densité", caption = "À noter que l'échelle de densité est deux fois plus grande")+
     scale_y_continuous(limits=(c(0, 3.1)))


suppressWarnings(print(co2_1955 + co2_1975 +co2_1995+ co2_2015) +  plot_annotation(title = "Distribution des émissions de CO2 par habitant à chaque 20 ans depuis 1955"))
```

###### Lors des années 1950, les pays avaient des PIB par habitant beacoup plus similaire et plus bas.
